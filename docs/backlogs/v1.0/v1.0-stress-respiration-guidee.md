# üìù Plan de D√©veloppement - Feature Exercices Respiration Guid√©e (MVP v1.0)

## üéØ Vue d'ensemble

### Description de la Feature
Interface simple proposant des exercices de respiration guid√©e de 2-5 minutes pour g√©rer le stress et l'anxi√©t√© li√©s au SOPK avec des techniques valid√©es.

### Valeur Utilisateur
- **Soulagement imm√©diat** : Outils rapides contre stress et anxi√©t√©
- **Accessibilit√©** : Disponible n'importe o√π, n'importe quand
- **Impact hormonal** : R√©duction cortisol et am√©lioration √©quilibre SOPK

### Score RICE
- **Reach** : 4/5 (80% des utilisatrices SOPK ont du stress)
- **Impact** : 4/5 (effet imm√©diat et mesurable)
- **Confidence** : 5/5 (technique √©prouv√©e)
- **Effort** : 1/5 (impl√©mentation tr√®s simple)
- **Score Final** : **80** ‚úÖ **Priorit√© #1**

---

## üîÑ Diagrammes de Flux

### User Journey - Session Respiration

```mermaid
flowchart TD
    A[Utilisatrice ressent du stress] --> B[Ouvre app ou notification]
    B --> C[Dashboard ou module Stress]
    C --> D[Bouton 'Faire une respiration']

    D --> E[S√©lection technique]
    E --> F{Type choisi?}

    F -->|Coh√©rence cardiaque| G[4-7-8 Technique]
    F -->|Box breathing| H[4-4-4-4 Pattern]
    F -->|Respiration rapide| I[Technique 2min]

    G --> J[Interface guid√©e visuelle]
    H --> J
    I --> J

    J --> K[Animation cercle/vagues]
    K --> L[Instructions audio/texte]
    L --> M[Progression temps r√©el]
    M --> N[Fin session - feedback]
    N --> O[Journal humeur post-session]
    O --> P[Retour Dashboard avec mise √† jour]

    style A fill:#ffcdd2
    style J fill:#e1f5fe
    style N fill:#e8f5e8
```

### Architecture Technique

```mermaid
graph TB
    subgraph "Module Stress - src/modules/stress/"
        A[BreathingExercisesView.jsx] --> B[BreathingSession.jsx]
        B --> C[BreathingGuide.jsx]
        B --> D[SessionControls.jsx]
        B --> E[ProgressIndicator.jsx]

        B --> F[useBreathingSession Hook]
        F --> G[breathingTechniques.js]
        F --> H[breathingService.js]
    end

    subgraph "Shared Components - src/shared/"
        I[CircleAnimation.jsx]
        J[AudioPlayer.jsx]
        K[Timer.jsx]
        L[useTimer Hook]
        M[useAudio Hook]
    end

    subgraph "Database - Supabase"
        H --> N[(breathing_sessions)]
    end

    C --> I
    B --> J
    B --> K
    F --> L
    F --> M

    style A fill:#e3f2fd
    style H fill:#c8e6c9
    style N fill:#ffcdd2
    style I fill:#fff3e0
```

### Flux de Donn√©es

```mermaid
sequenceDiagram
    participant U as Utilisatrice
    participant C as Component
    participant H as Hook
    participant T as Timer
    participant S as Service
    participant DB as Supabase

    U->>C: S√©lectionne technique
    C->>H: startBreathingSession(technique)
    H->>T: initializeTimer(duration)
    H->>H: setState(active)

    loop Chaque cycle respiration
        T->>H: tick()
        H->>C: updatePhase(inhale/hold/exhale)
        C->>U: Animation + instructions
    end

    T->>H: sessionComplete()
    H->>S: saveSession(data)
    S->>DB: INSERT breathing_sessions
    DB-->>S: Success
    S-->>H: sessionSaved
    H-->>C: showCompletionFeedback
    C-->>U: √âcran de fin avec bilan
```

---

## üèóÔ∏è Architecture Technique

### Structure des Donn√©es

```sql
-- Table pour tracking des sessions
CREATE TABLE breathing_sessions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,

  -- Donn√©es de session
  technique VARCHAR(50) NOT NULL, -- 'box', 'coherence', 'quick'
  duration_seconds INTEGER NOT NULL,
  completed BOOLEAN DEFAULT false,
  interruption_reason VARCHAR(100), -- si pas compl√©t√©e

  -- Feedback utilisateur
  stress_before INTEGER CHECK (stress_before >= 1 AND stress_before <= 10),
  stress_after INTEGER CHECK (stress_after >= 1 AND stress_after <= 10),
  feeling_after VARCHAR(20), -- 'calmer', 'same', 'better'

  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### Structure Modulaire

#### Module Stress (`src/modules/stress/`)
```
src/modules/stress/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ BreathingSession.jsx          # Session active
‚îÇ   ‚îú‚îÄ‚îÄ BreathingGuide.jsx            # Animation + instructions
‚îÇ   ‚îú‚îÄ‚îÄ TechniqueSelector.jsx         # Choix de technique
‚îÇ   ‚îú‚îÄ‚îÄ SessionControls.jsx           # Play/Pause/Stop
‚îÇ   ‚îú‚îÄ‚îÄ ProgressIndicator.jsx         # Progression temps
‚îÇ   ‚îî‚îÄ‚îÄ CompletionFeedback.jsx        # √âcran de fin
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ useBreathingSession.js        # Hook principal session
‚îÇ   ‚îî‚îÄ‚îÄ useBreathingStats.js          # Statistiques utilisateur
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ breathingService.js           # API calls sessions
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ breathing.types.js            # Types techniques respiration
‚îú‚îÄ‚îÄ views/
‚îÇ   ‚îî‚îÄ‚îÄ BreathingExercisesView.jsx    # Point d'entr√©e
‚îî‚îÄ‚îÄ utils/
    ‚îú‚îÄ‚îÄ breathingTechniques.js        # Config des techniques
    ‚îî‚îÄ‚îÄ breathingHelpers.js           # Calculs et utilitaires
```

#### Composants Partag√©s (`src/shared/`)
```
src/shared/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ animations/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CircleAnimation.jsx       # Animation respiration
‚îÇ   ‚îî‚îÄ‚îÄ ui/
‚îÇ       ‚îú‚îÄ‚îÄ Timer.jsx                 # Timer g√©n√©rique
‚îÇ       ‚îú‚îÄ‚îÄ AudioPlayer.jsx           # Player audio guid√©
‚îÇ       ‚îî‚îÄ‚îÄ StressSlider.jsx          # Slider niveau stress
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ useTimer.js                   # Hook timer r√©utilisable
‚îÇ   ‚îú‚îÄ‚îÄ useAudio.js                   # Hook gestion audio
‚îÇ   ‚îî‚îÄ‚îÄ useVibration.js               # Hook vibration mobile
‚îî‚îÄ‚îÄ utils/
    ‚îú‚îÄ‚îÄ audioHelpers.js               # Utilitaires audio
    ‚îî‚îÄ‚îÄ animationHelpers.js           # Utilitaires animation
```

### Services API

```javascript
// src/modules/stress/services/breathingService.js
export const breathingService = {
  // Sauvegarder une session
  async saveSession(userId, sessionData) {
    const { error } = await supabase
      .from('breathing_sessions')
      .insert({
        user_id: userId,
        ...sessionData
      });
    return { error };
  },

  // R√©cup√©rer les sessions du jour
  async getTodaySessions(userId) {
    const today = new Date().toISOString().split('T')[0];
    const { data, error } = await supabase
      .from('breathing_sessions')
      .select('*')
      .eq('user_id', userId)
      .gte('created_at', `${today}T00:00:00`)
      .order('created_at', { ascending: false });
    return { data, error };
  },

  // Statistiques hebdomadaires
  async getWeeklyStats(userId) {
    const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
    const { data, error } = await supabase
      .from('breathing_sessions')
      .select('technique, duration_seconds, stress_before, stress_after, created_at')
      .eq('user_id', userId)
      .eq('completed', true)
      .gte('created_at', weekAgo.toISOString());
    return { data, error };
  }
};
```

---

## üé® Design UX/UI

### Interface Mobile-First

#### S√©lection de Technique
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   üßò Respiration Guid√©e  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                         ‚îÇ
‚îÇ  Choisis ton exercice   ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  üîµ Coh√©rence cardiaque ‚îÇ
‚îÇ  ‚è±Ô∏è  5 minutes          ‚îÇ
‚îÇ  üíô √âquilibre √©motionnel ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  ‚èπÔ∏è  Respiration 4-4-4-4 ‚îÇ
‚îÇ  ‚è±Ô∏è  3 minutes          ‚îÇ
‚îÇ  üéØ Focus et concentration‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  ‚ö° Technique rapide     ‚îÇ
‚îÇ  ‚è±Ô∏è  2 minutes          ‚îÇ
‚îÇ  üöÄ Anti-stress express  ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  üìä Mes statistiques     ‚îÇ
‚îÇ  3 sessions cette semaine‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Session Active
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Coh√©rence Cardiaque    ‚îÇ
‚îÇ  ‚è±Ô∏è  2:34 restantes     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                         ‚îÇ
‚îÇ       ‚óØ‚îÄ‚îÄ‚îÄ‚îÄ‚óØ‚îÄ‚îÄ‚îÄ‚îÄ‚óØ       ‚îÇ
‚îÇ     /           \       ‚îÇ
‚îÇ    ‚óØ             ‚óØ      ‚îÇ ‚Üê Animation
‚îÇ     \           /       ‚îÇ   cercle
‚îÇ       ‚óØ‚îÄ‚îÄ‚îÄ‚îÄ‚óØ‚îÄ‚îÄ‚îÄ‚îÄ‚óØ       ‚îÇ   qui pulse
‚îÇ                         ‚îÇ
‚îÇ    üí® INSPIRE... 4s     ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  ‚è∏Ô∏è  Pause    üõë  Arr√™t  ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  Stress avant: üò∞ 8/10  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Feedback de Fin
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      ‚ú® Bravo !         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                         ‚îÇ
‚îÇ  Session termin√©e       ‚îÇ
‚îÇ  üïê 5 minutes           ‚îÇ
‚îÇ  üíö Technique ma√Ætris√©e  ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  Comment te sens-tu?    ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  Niveau de stress:      ‚îÇ
‚îÇ  ‚óè‚óè‚óã‚óã‚óã‚óã‚óã‚óã‚óã‚óã  2/10      ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  üòå Plus calme          ‚îÇ
‚îÇ  üòê Pareil              ‚îÇ
‚îÇ  üòä Bien mieux          ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  [Terminer] [Nouvelle]  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Design System - Couleurs & Animation

```css
:root {
  /* Couleurs respiration */
  --breathing-primary: #4FC3F7;     /* Bleu apaisant */
  --breathing-inhale: #81C784;      /* Vert inspiration */
  --breathing-hold: #FFB74D;        /* Orange r√©tention */
  --breathing-exhale: #F48FB1;      /* Rose expiration */

  /* Animations */
  --circle-size-min: 80px;
  --circle-size-max: 160px;
  --transition-breathing: cubic-bezier(0.4, 0, 0.6, 1);
}

.breathing-circle {
  width: var(--circle-size-min);
  height: var(--circle-size-min);
  border-radius: 50%;
  background: radial-gradient(circle, var(--breathing-primary), transparent);
  transition: all var(--transition-breathing);
}

.breathing-circle.inhale {
  width: var(--circle-size-max);
  height: var(--circle-size-max);
  background: radial-gradient(circle, var(--breathing-inhale), transparent);
}
```

---

## üì± User Stories D√©taill√©es

### US1: Acc√®s Rapide Anti-Stress
**En tant qu'** utilisatrice SOPK stress√©e
**Je veux** d√©marrer un exercice de respiration en moins de 10 secondes
**Afin de** g√©rer mon stress imm√©diatement

**Crit√®res d'acceptation** :
- [ ] Bouton "Respiration" accessible depuis le dashboard
- [ ] Lancement direct sans configuration complexe
- [ ] Proposition de la technique la plus utilis√©e par d√©faut
- [ ] Interface claire m√™me en situation de stress
- [ ] Pas d'inscription/login requis pour essayer

### US2: Techniques Adapt√©es SOPK
**En tant qu'** utilisatrice SOPK
**Je veux** des exercices sp√©cifiquement efficaces pour mon stress hormonal
**Afin de** maximiser l'impact sur mes sympt√¥mes

**Crit√®res d'acceptation** :
- [ ] 3 techniques maximum pour √©viter l'ind√©cision
- [ ] Dur√©es courtes (2-5 min) adapt√©es au rythme de vie
- [ ] Explications simples des bienfaits pour le SOPK
- [ ] Instructions audio optionnelles (pas obligatoires)
- [ ] Possibilit√© de personnaliser la dur√©e

### US3: Feedback et Progression
**En tant qu'** utilisatrice
**Je veux** voir l'impact des exercices sur mon niveau de stress
**Afin de** rester motiv√©e √† continuer

**Crit√®res d'acceptation** :
- [ ] Mesure stress avant/apr√®s (√©chelle 1-10)
- [ ] Visualisation simple de l'am√©lioration imm√©diate
- [ ] Statistiques hebdomadaires basiques (nombre de sessions)
- [ ] Corr√©lation avec le journal humeur si compl√©t√©
- [ ] Encouragements bienveillants sans culpabilisation

---

## üõ†Ô∏è Impl√©mentation D√©taill√©e

### Sprint 1: Fondations (Semaine 1)
**Objectif** : Infrastructure technique et premi√®re technique

**T√¢ches** :
1. **Setup base de donn√©es**
   ```sql
   -- Table sessions + index pour performances
   CREATE INDEX idx_breathing_sessions_user_date
   ON breathing_sessions(user_id, created_at DESC);
   ```

2. **Configuration techniques de base**
   ```javascript
   // src/modules/stress/utils/breathingTechniques.js
   export const techniques = {
     coherence: {
       name: 'Coh√©rence cardiaque',
       duration: 300, // 5 min
       pattern: [5, 0, 5, 0], // inspire, pause, expire, pause
       description: '√âquilibre ton syst√®me nerveux',
       icon: 'üîµ'
     },
     box: {
       name: 'Respiration 4-4-4-4',
       duration: 180, // 3 min
       pattern: [4, 4, 4, 4],
       description: 'Focus et concentration',
       icon: '‚èπÔ∏è'
     },
     quick: {
       name: 'Technique rapide',
       duration: 120, // 2 min
       pattern: [4, 2, 6, 1], // 4-7-8 adapt√©
       description: 'Anti-stress express',
       icon: '‚ö°'
     }
   };
   ```

3. **Hook timer partag√©**
   ```javascript
   // src/shared/hooks/useTimer.js
   import { useState, useRef, useCallback } from 'react';

   export const useTimer = (initialDuration = 0) => {
     const [timeLeft, setTimeLeft] = useState(initialDuration);
     const [isRunning, setIsRunning] = useState(false);
     const intervalRef = useRef();

     const start = useCallback(() => {
       setIsRunning(true);
       intervalRef.current = setInterval(() => {
         setTimeLeft(prev => {
           if (prev <= 1) {
             setIsRunning(false);
             return 0;
           }
           return prev - 1;
         });
       }, 1000);
     }, []);

     return { timeLeft, isRunning, start, pause, reset };
   };
   ```

4. **Service API minimal**
   ```javascript
   // Version simplifi√©e pour commencer
   const mockSaveSession = async (data) => {
     console.log('Session sauvegard√©e:', data);
     return { error: null };
   };
   ```

### Sprint 2: UX/UI Core (Semaine 2)
**Objectif** : Interface utilisateur fonctionnelle et attrayante

**T√¢ches** :
1. **Composant d'animation cercle**
   ```jsx
   // src/shared/components/animations/CircleAnimation.jsx
   import { useState, useEffect } from 'react';

   export const CircleAnimation = ({ phase, isActive }) => {
     const [scale, setScale] = useState(1);

     useEffect(() => {
       if (!isActive) return;

       const scaleMap = {
         inhale: 1.5,
         hold: 1.5,
         exhale: 1,
         pause: 1
       };

       setScale(scaleMap[phase] || 1);
     }, [phase, isActive]);

     return (
       <div
         className={`breathing-circle transition-transform duration-[4000ms] ease-in-out`}
         style={{ transform: `scale(${scale})` }}
       />
     );
   };
   ```

2. **S√©lecteur de technique**
   ```jsx
   // src/modules/stress/components/TechniqueSelector.jsx
   import { techniques } from '../utils/breathingTechniques';

   export const TechniqueSelector = ({ onSelect }) => {
     return (
       <div className="space-y-4 p-4">
         {Object.entries(techniques).map(([key, technique]) => (
           <button
             key={key}
             onClick={() => onSelect(key)}
             className="w-full p-4 text-left border rounded-lg hover:bg-blue-50"
           >
             <div className="flex items-center gap-3">
               <span className="text-2xl">{technique.icon}</span>
               <div className="flex-1">
                 <h3 className="font-medium">{technique.name}</h3>
                 <p className="text-sm text-gray-600">{technique.description}</p>
                 <p className="text-xs text-gray-500">
                   ‚è±Ô∏è {Math.floor(technique.duration / 60)} minutes
                 </p>
               </div>
             </div>
           </button>
         ))}
       </div>
     );
   };
   ```

3. **Hook principal session**
   ```jsx
   // src/modules/stress/hooks/useBreathingSession.js
   import { useState } from 'react';
   import { useTimer } from '../../../shared/hooks/useTimer';
   import { techniques } from '../utils/breathingTechniques';

   export const useBreathingSession = (techniqueId) => {
     const technique = techniques[techniqueId];
     const { timeLeft, isRunning, start, pause, reset } = useTimer(technique?.duration);

     const [currentPhase, setCurrentPhase] = useState('inhale'); // inhale, hold, exhale, pause
     const [cycleProgress, setCycleProgress] = useState(0);
     const [stressBefore, setStressBefore] = useState(null);
     const [stressAfter, setStressAfter] = useState(null);

     // Logique de cycle de respiration
     // ... d√©tails d'impl√©mentation

     return {
       currentPhase,
       cycleProgress,
       timeLeft,
       isRunning,
       start,
       pause,
       reset,
       stressBefore,
       stressAfter,
       setStressBefore,
       setStressAfter
     };
   };
   ```

### Sprint 3: Logique M√©tier (Semaine 3)
**Objectif** : Fonctionnalit√©s compl√®tes avec persistance des donn√©es

**T√¢ches** :
1. **Session compl√®te avec sauvegarde**
   ```jsx
   // src/modules/stress/components/BreathingSession.jsx
   import { BreathingGuide } from './BreathingGuide';
   import { SessionControls } from './SessionControls';
   import { useBreathingSession } from '../hooks/useBreathingSession';

   export const BreathingSession = ({ techniqueId, onComplete }) => {
     const session = useBreathingSession(techniqueId);

     const handleSessionComplete = async () => {
       const sessionData = {
         technique: techniqueId,
         duration_seconds: techniques[techniqueId].duration - session.timeLeft,
         completed: session.timeLeft === 0,
         stress_before: session.stressBefore,
         stress_after: session.stressAfter
       };

       await breathingService.saveSession(user.id, sessionData);
       onComplete(sessionData);
     };

     return (
       <div className="breathing-session">
         <BreathingGuide
           phase={session.currentPhase}
           isActive={session.isRunning}
           technique={techniques[techniqueId]}
         />
         <SessionControls session={session} />
         {session.timeLeft === 0 && (
           <CompletionFeedback onComplete={handleSessionComplete} />
         )}
       </div>
     );
   };
   ```

2. **Feedback de fin avec tracking**
   ```jsx
   // src/modules/stress/components/CompletionFeedback.jsx
   export const CompletionFeedback = ({ stressBefore, onStressAfterChange, onComplete }) => {
     const [feeling, setFeeling] = useState('');

     return (
       <div className="completion-feedback p-6 text-center">
         <div className="mb-6">
           <h2 className="text-2xl mb-2">‚ú® Bravo !</h2>
           <p className="text-gray-600">Session termin√©e</p>
         </div>

         <div className="mb-6">
           <label className="block text-sm font-medium mb-2">
             Comment te sens-tu maintenant ?
           </label>
           <StressSlider
             value={stressAfter}
             onChange={onStressAfterChange}
             label="Niveau de stress"
           />
         </div>

         <div className="flex gap-2 mb-6">
           {['Plus calme', 'Pareil', 'Bien mieux'].map(option => (
             <button
               key={option}
               onClick={() => setFeeling(option)}
               className={`px-4 py-2 rounded-full ${
                 feeling === option ? 'bg-blue-500 text-white' : 'bg-gray-200'
               }`}
             >
               {option}
             </button>
           ))}
         </div>

         <button
           onClick={() => onComplete({ feeling_after: feeling })}
           className="w-full bg-green-500 text-white py-3 rounded-lg"
         >
           Terminer
         </button>
       </div>
     );
   };
   ```

---

## üß™ Tests & Validation

### Tests Unitaires (Vitest)
```javascript
describe('useBreathingSession Hook', () => {
  test('d√©marre une session et g√®re les phases', () => {
    const { result } = renderHook(() => useBreathingSession('coherence'));

    expect(result.current.currentPhase).toBe('inhale');
    expect(result.current.timeLeft).toBe(300); // 5 minutes

    act(() => {
      result.current.start();
    });

    expect(result.current.isRunning).toBe(true);
  });

  test('calcule correctement les phases de respiration', () => {
    // Test de la logique de cycle respiration
    // ...
  });
});
```

### Tests d'Int√©gration
```javascript
describe('Breathing Exercise E2E', () => {
  test('flow complet de session', async () => {
    render(<BreathingExercisesView />);

    // S√©lectionner technique
    fireEvent.click(screen.getByText('Coh√©rence cardiaque'));

    // √âvaluer stress avant
    const stressSlider = screen.getByLabelText(/stress avant/i);
    fireEvent.change(stressSlider, { target: { value: '8' } });

    // D√©marrer session
    fireEvent.click(screen.getByText('Commencer'));

    // Simuler fin de session
    act(() => {
      jest.advanceTimersByTime(300000); // 5 minutes
    });

    // V√©rifier feedback
    expect(screen.getByText('Bravo !')).toBeInTheDocument();

    // Compl√©ter feedback
    fireEvent.change(screen.getByLabelText(/stress apr√®s/i), { target: { value: '3' } });
    fireEvent.click(screen.getByText('Plus calme'));
    fireEvent.click(screen.getByText('Terminer'));

    // V√©rifier sauvegarde
    await waitFor(() => {
      expect(mockBreathingService.saveSession).toHaveBeenCalledWith(
        expect.any(String),
        expect.objectContaining({
          stress_before: 8,
          stress_after: 3,
          feeling_after: 'Plus calme'
        })
      );
    });
  });
});
```

### Crit√®res de Validation MVP
- [ ] **Performance** : D√©marrage session < 2 secondes
- [ ] **UX** : 95% des utilisatrices compl√®tent une session 2-5 min
- [ ] **Impact** : R√©duction moyenne stress de 2+ points sur 10
- [ ] **Engagement** : 60% utilisent 3+ fois par semaine apr√®s 2 semaines
- [ ] **Technique** : Animations fluides 60fps sur tous mobiles

---

## üöÄ D√©ploiement & Monitoring

### Variables d'Environnement
```env
# Audio et animations
VITE_ENABLE_AUDIO_GUIDE=true
VITE_ENABLE_VIBRATION=true
VITE_ANIMATION_REDUCED_MOTION=false

# Feature flags
VITE_ENABLE_STRESS_TRACKING=true
VITE_ENABLE_SESSION_SHARING=false
```

### M√©triques Cl√©s
```javascript
// Analytics events sp√©cifiques respiration
const trackBreathingEvents = {
  technique_selected: (technique) => analytics.track('Breathing Technique Selected', { technique }),
  session_started: (technique, duration) => analytics.track('Breathing Session Started', { technique, duration }),
  session_completed: (technique, duration, stress_reduction) => analytics.track('Breathing Session Completed', {
    technique,
    duration,
    stress_reduction
  }),
  session_interrupted: (technique, duration_completed, reason) => analytics.track('Breathing Session Interrupted', {
    technique,
    duration_completed,
    reason
  }),
  stress_improvement: (before, after, technique) => analytics.track('Stress Level Improved', {
    stress_before: before,
    stress_after: after,
    improvement: before - after,
    technique
  })
};
```

### Dashboard Monitoring
- **Engagement** : Sessions par utilisatrice par semaine
- **Efficacit√©** : Am√©lioration moyenne niveau de stress
- **Techniques** : Pr√©f√©rences et taux de compl√©tion par technique
- **Abandons** : Moments d'interruption pour am√©liorer UX

---

## üîÑ √âvolutions Post-MVP

### Version 1.1
- **Audio guid√©** avec voix bienveillante fran√ßaise
- **Mode nuit** avec animations douces pour coucher
- **Rappels intelligents** bas√©s sur niveaux de stress du journal

### Version 1.2
- **Techniques personnalis√©es** adapt√©es au cycle menstruel
- **Partage de sessions** avec proches (anonymis√©)
- **Int√©gration capteurs** (Apple Watch, Fitbit) pour mesure HRV

---

## ‚úÖ Definition of Done

### Crit√®res Techniques
- [ ] Code review√© et couvert √† 90%+ par les tests
- [ ] Animations test√©es sur iPhone 8+ et Android 7+
- [ ] Audio facultatif et accessible (sous-titres si n√©cessaire)
- [ ] Mode hors-ligne pour toutes les techniques
- [ ] Bundle size < 50kb pour ce module

### Crit√®res Utilisateur
- [ ] Tests utilisateur > 4.5/5 facilit√© d'utilisation
- [ ] 0 feedback n√©gatif sur culpabilisation ou jugement
- [ ] Onboarding int√©gr√© expliquant bienfaits SOPK
- [ ] Transition fluide vers/depuis autres modules
- [ ] Guide d'accessibilit√© pour malvoyants

### Crit√®res Business
- [ ] Tracking complet des sessions pour analytics
- [ ] A/B test pr√©vu pour techniques par d√©faut
- [ ] Documentation compl√®te pour support client
- [ ] Plan de contenu audio pour versions futures

---

*üìã Cette feature est con√ßue comme un outil th√©rapeutique l√©ger mais efficace, priorit√© absolue du MVP pour son impact imm√©diat sur le bien-√™tre des utilisatrices SOPK.*